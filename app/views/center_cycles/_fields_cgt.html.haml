:javascript
  $(document).ready(function() {
    $("#cgt_date_one, #cgt_date_two").change(function() {
      cgt_start_date = jQuery("#cgt_date_one").val();
      cgt_end_date = jQuery("#cgt_date_two").val();
      cgt_start_date = ddmmyyyyToDate(cgt_start_date);
      cgt_end_date = ddmmyyyyToDate(cgt_end_date);
      oneDay  = 24*60*60*1000;
      diffDays = (cgt_end_date.getTime() - cgt_start_date.getTime()) / oneDay;
      if (isNaN(diffDays) || (diffDays < 0)) {
        $("#days_between_dates").attr('value', "0");
      }
      else {
        $("#days_between_dates").attr('value', diffDays);
      }
    });
  });

.shaded
  - if @center_cycle && !@center_cycle.blank?
    = form(:action => url(:controller => 'center_cycles', :action => 'record_cgt'), :method => :post) do
      = hidden_field :name => :parent_location_id, :value => @branch.id
      = hidden_field :name => :child_location_id, :value => @center.id
      = hidden_field :name => 'center_cycle_number', :value => @center_cycle_number
      %table.form
        %h1
          = "Record CGT"
          %tr
            %th CGT Start Date:
            %td
              = date_select :cgt_date_one
            %th No. of days
            %td
              = text_field :name => :days_difference, :readonly => 'true', :id => "days_between_dates", :size => 5
              %td
                .greytext
                  = "(No. of days between CGT Start date and CGT End date)"
          %tr
            %th CGT End Date:
            %td
              = date_select :cgt_date_two
          %table.narrow.form{:style => "width:100%;"}
            %tfoot
              %tr
                %td
                  %b CGT recorded by:
                  = get_session_user_name
                  = hidden_field :name => 'cgt_performed_by_staff', :value => get_session_user_id
                %td
                  = submit 'Save', :class => "grey_button"