- all_repayment_style_choices = [[NORMAL_REPAYMENT_STYLE,"fees=>int=>prin"], [PRORATA_REPAYMENT_STYLE,"pro rata"]]
- default_repayment_style = Mfi.first.default_repayment_style ? Mfi.first.default_repayment_style : NORMAL_REPAYMENT_STYLE
- default_repayment_style_choice = all_repayment_style_choices.select {|style| style[0] == default_repayment_style}
- repayment_style_choices = Mfi.first.allow_choice_of_repayment_style ? default_repayment_style_choice + (all_repayment_style_choices.reject {|style| style[0] == default_repayment_style}) : default_repayment_style_choice

%table.form
  %tr
    %td
      Amount
    %td
      = text_field :amount
  %tr
    %td
      Type
    %td
      = select :type, :collection => [:total] + Payment.types, :text_method => :to_s, :value_method => :to_s
  %tr
    %td
      Repayment Style
    %td
      = repayment_style_select
      %span.small
        only applies to "total" repayment type
  %tr
    %td Received:
    %td
      on&nbsp;&nbsp;
      = date_select_for @payment, :received_on
      &nbsp;&nbsp;by&nbsp;&nbsp;
      = select :received_by_staff_id, :collection => staff_members_collection()
  %tr
    %td
    %td
      = submit submit_text
      &nbsp;&nbsp;
      = link_to 'cancel', cancel_link
