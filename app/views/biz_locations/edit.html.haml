:javascript
  $(document).ready(function() {
    $('#meeting_schedule').attr('checked', false);
    $('#location_level_selector option:first').attr('selected', true);
    $('td.assign_products').find('input:checkbox').attr('checked', true);
    $('#meeting_schedule').change(function() {
      jQuery('.meeting_div').toggle();
    });
    $('#location_level_selector').live('change', function(){
      if(jQuery(this).val()=='0'){
        jQuery('.center_meeting_div').show();
        jQuery('.date').show();
      }else{
        jQuery('.center_meeting_div').hide();
        jQuery('.date').hide();
      }
    });
  });
%h1 Edit the details of: #{@biz_location.name}
= form_for(@biz_location, :action => resource(@biz_location,:update_biz_location)) do

  = hidden_field :location_level, :value => @biz_location.location_level.level
  %table.tall.shaded
    %tr
      %th
        Location Level
      %td
        = @biz_location.location_level.name
    %tr
      %th
        Name
      %td
        = text_field :name
    %tr
      %th
        Creation Date
      %td
        = @biz_location.creation_date
    %tr
      %th
        Address
      %td
        = text_area :biz_location_address, :rows => 6, :cols => 38
    - if @biz_location.location_level.level == 0
      %tr
        %th
          Default Disbursal Date
        %td
          = date_select_for @biz_location, :center_disbursal_date
    %tr
      %th
        Originator By
      %td
        = select :originator_by, :collection => @staff_members, :text_method => :name, :value_method => :id, :prompt => 'Select Staff Member'
    %tr
      %th
        Managed By
      %td
        = select :name => :managed_by, :collection => @staff_members, :selected => @managed_by_staff.id.to_s, :prompt => 'Select Staff Member', :text_method => :name, :value_method => :id
      %th
        Manage On Date
      %td
        = date_select 'on_date', get_effective_date
    - if @biz_location.location_level.level == 1
      - lending_products = @biz_location.lending_products
      - unassign_lending_products = LendingProduct.all - lending_products
      %tr
        %th
          Loan Product
        %td.assign_products
          = select :name => 'lending_product_ids', :collection => lending_products, :text_method => :name, :value_method => :id, :prompt => "Select Loan Product ", :class => 'multiple'
      %tr
        %th
          Assign New Loan Product
        %td
          = select :name => 'new_lending_product_ids', :collection => unassign_lending_products, :text_method => :name, :value_method => :id, :prompt => "Select Loan Product ", :class => 'multiple'
    - if @biz_location.location_level.level == 0
      %tr{:class => 'center_meeting_div'}
        %td
          Create Meeting Schedule
          = check_box :name => 'meeting_schedule', :value => true, :checked => false, :id => 'meeting_schedule'
    %tr{:style => "display:none", :class => 'meeting_div'}
      %th
        No. Of Meetings
      %td
        = text_field :name => "meeting[meeting_numbers]"
    %tr{:style => "display:none", :class => 'meeting_div'}
      %th
        Meeting Frequency
      %td
        = select :name => "meeting[meeting_frequency]", :collection => Constants::Time::MEETING_FREQUENCIES.collect{|c| c.to_s}
    %tr{:style => "display:none", :class => 'meeting_div'}
      %th
        Meeting Time
      %td
        = text_field :name => "meeting[meeting_time_begins_hours]", :size => 2, :maxlength => 2
        %b
        = text_field :name => "meeting[meeting_time_begins_minutes]", :size => 2, :maxlength => 2
        &nbsp;&nbsp;
        %span.greytext time is in a 24 hour format
  = submit "Update", :class => "grey_button"
  &nbsp;&nbsp;
  %b
    Or
  &nbsp;&nbsp;
  - if @biz_location.location_level.level == 0
    = link_to_with_rights 'Cancel', url("user_locations/weeksheet_collection/#{@biz_location.id}"), :class => "grey_button"
  - else
    = link_to_with_rights 'Cancel', url("user_locations/show/#{@biz_location.id}"), :class => "grey_button"