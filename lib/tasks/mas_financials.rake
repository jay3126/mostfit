require "rubygems"

# Add the local gems dir if found within the app root; any dependencies loaded
# hereafter will try to load from the local gems before loading system gems.
if (local_gem_dir = File.join(File.dirname(__FILE__), '..', '..', 'gems')) && $BUNDLE.nil?
  $BUNDLE = true; Gem.clear_paths; Gem.path.unshift(local_gem_dir)
end

require "merb-core"

# this loads all plugins required in your init file so don't add them
# here again, Merb will do it for you
Merb.start_environment(:environment => ENV['MERB_ENV'] || 'development')

namespace :mostfit do
  desc "Generates report of MAS financials for Intellecash"
  task :mas_financials do

    client_ids = [17771, 17774, 17776, 17777, 17779, 17746, 17747, 17748, 17749, 17750, 17775, 17753, 17764, 17768, 17770, 17758, 17760, 17762, 17763, 17765, 17737, 17739, 9451, 9454, 9457, 9455, 9453, 9449, 9448, 9458, 17731, 17732, 17733, 7124, 7120, 7121, 7122, 6239, 7123, 6237, 6245, 6240, 6243, 6249, 6248, 7450, 7449, 7448, 7447, 7454, 7453, 7452, 7455, 7451, 17734, 7291, 17789, 7292, 7295, 7293, 7286, 7289, 7288, 7290, 17790, 7296, 7287, 7302, 7304, 7305, 17798, 17799, 17800, 17801, 17802, 17791, 17792, 17793, 17794, 17795, 186, 183, 184, 185, 7702, 7911, 7908, 7912, 17796, 17797, 17803, 17804, 17805, 17806, 17807, 17808, 17809, 17810, 17811, 17812, 17833, 17834, 17835, 17836, 17837, 17813, 17814, 17815, 17816, 17821, 17826, 17828, 17830, 17831, 17832, 17838, 17840, 17841, 17839, 17842, 17817, 17818, 17819, 17820, 17822, 17823, 17824, 17825, 17827, 17829, 17843, 17844, 17845, 17846, 17847, 17848, 17849, 17850, 17851, 17852, 17853, 17854, 17855, 17856, 17857, 17858, 17859, 17860, 17861, 17862, 17878, 7307, 7312, 7333, 7313, 17879, 7309, 7327, 7325, 17880, 17881, 7341, 17882, 7334, 17883, 17863, 17864, 17865, 17866, 17867, 17868, 17869, 17870, 17871, 17872, 17873, 17874, 17875, 17876, 17877, 17914, 17915, 17916, 17917, 17918, 17884, 17885, 17887, 17888, 17889, 17890, 17893, 17894, 17896, 17897, 17899, 17900, 17901, 17903, 17904, 17920, 17922, 17923, 17924, 17926, 17905, 17907, 17908, 17910, 17911, 17931, 17932, 17933, 17934, 17935, 17936, 17937, 17939, 17940, 17941, 17943, 17944, 17945, 17946, 17947, 17948, 17949, 17950, 17951, 17952, 17953, 6949, 6971, 6960, 17954, 6977, 17955, 17956, 6970, 6954, 17957, 6958, 17958, 6956, 6951, 17987, 17973, 17974, 17978, 17981, 17969, 17970, 17971, 17984, 17972, 17913, 17912, 17909, 17891, 17906, 17886, 17892, 17895, 17902, 17898, 18056, 18061, 18063, 18064, 18065, 18069, 18071, 18072, 18073, 18075, 18077, 18078, 18080, 18081, 18082, 18053, 18054, 18055, 18066, 18067, 18046, 18048, 18049, 18051, 18052, 18006, 18008, 18009, 18060, 18089, 18092, 18095, 18097, 17919, 17921, 17925, 17929, 17930, 17938, 17942, 17959, 17961, 17963, 18042, 18043, 18044, 18045, 18047, 18013, 18014, 18015, 18018, 18019, 18020, 18022, 18023, 18024, 18025, 18026, 18027, 18028, 18029, 18030, 18011, 18021, 7607, 7606, 7608, 7611, 7614, 17960, 17962, 7615, 7612, 7619, 7610, 7613, 17964, 17965, 17966, 7605, 7617, 7618, 17967, 17968, 17569, 17571, 7665, 7669, 7666, 7667, 7668, 7663, 7661, 7664, 7387, 7381, 7384, 7386, 18031, 18033, 7261, 7264, 7266, 18032, 7262, 18035, 18036, 18038, 18039, 190, 640, 17989, 189, 17927, 17991, 17992, 17928, 17994, 7657, 7658, 7655, 7656, 18041, 18068, 18070, 18074, 18076, 18079, 18083, 18084, 18085, 18086, 18088, 18096, 18099, 18100, 17995, 18101, 17999, 18001, 18103, 18007, 18010, 18012, 17975, 17976, 17977, 17979, 17980, 17982, 17983, 17985, 17986, 17988, 18050, 18057, 18058, 18059, 18062, 18087, 18090, 18091, 18093, 18094, 7415, 7418, 7412, 7413, 7416, 7419, 18119, 7414, 7422, 7421, 18124, 7436, 7439, 7437, 7438, 18112, 18113, 18114, 18115, 18116, 18118, 18120, 18121, 18122, 18123, 18125, 18126, 18127, 18128, 18129, 18130, 18131, 18132, 18133, 18134, 18145, 18146, 18147, 18148, 18149, 18016, 18150, 18151, 18152, 18153, 18154, 7359, 7356, 7357, 7358, 7360, 5018, 18155, 18156, 18157, 18158, 18017, 18034, 18037, 18040, 17990, 17993, 17996, 17997, 17998, 18000, 18002, 18003, 18004, 18005, 18161, 18162, 18163, 18098, 18164, 18102, 18166, 18104, 18105, 18106, 18168, 95, 93, 7367, 23, 27, 36, 33, 32, 35, 24, 21, 25, 22, 92, 18107, 18108, 18109, 7516, 18110, 18111, 5167, 7510, 7513, 7517, 8429, 8431, 8430, 8433, 8432, 7848, 7846, 7844, 7852, 7850, 7464, 7463, 7462, 7461, 18169, 18117, 18135, 18136, 18137, 18138, 18139, 18140, 18141, 18142, 18159, 18143, 18144, 18160, 18165, 18167, 18170, 18171, 18172, 18173, 18174, 18175, 18176, 18177, 18178, 18179, 18180, 18181, 18182, 18183, 18184, 18185, 18186, 18187, 18188, 18189, 18190, 18191, 18192, 18193, 18194, 7400, 8791, 7396, 7404, 7403, 8790, 7399, 7408, 7406, 7409, 8793, 18256, 18257, 7397, 7405, 7402, 7407, 8792, 18195, 18205, 18260, 8794, 18207, 18209, 18211, 18212, 18213, 18215, 18216, 18217, 18218, 18219, 18220, 18221, 18222, 18223, 18226, 18230, 18231, 18232, 7629, 7627, 7628, 7625, 7626, 7632, 7634, 18243, 7633, 7624, 7630, 7620, 7623, 7622, 7621, 9358, 9355, 9353, 9361, 18248, 7898, 7897, 7901, 7904, 7905, 7899, 7900, 7902, 7903, 7906, 8352, 8353, 8354, 8351, 18249, 18196, 18197, 18198, 18199, 18200, 18201, 18202, 18203, 18204, 18206, 18208, 18210, 18214, 18293, 18294, 18224, 18225, 18227, 18228, 18229, 18233, 18234, 18235, 18236, 18237, 18238, 18239, 18240, 18241, 18242, 18296, 18297, 18298, 18300, 18301, 18302, 18303, 18304, 18305, 18306, 18250, 18251, 18252, 18253, 18254, 18255, 18258, 18259, 18261, 18262, 18263, 18264, 18265, 18266, 18267, 18323, 18324, 18325, 18326, 18327, 18328, 18329, 18330, 18331, 18332, 18335, 18337, 18339, 18340, 18341, 18342, 18343, 18344, 18345, 18346, 18311, 18313, 18314, 18315, 18316, 18317, 18318, 18320, 18321, 18322, 18351, 18353, 18355, 18356, 18358, 18360, 18361, 18362, 18364, 18365, 18367, 18368, 18369, 18370, 18371, 18372, 18373, 18374, 18375, 18376, 18283, 18284, 18285, 18286, 18287, 18288, 18289, 18290, 18291, 18292, 18347, 18348, 18349, 18350, 18363, 18352, 18354, 18357, 18359, 18366, 18278, 18279, 18280, 18281, 18282, 18307, 18308, 18309, 18310, 18312, 18319, 18333, 18334, 18336, 18338, 18377, 18378, 18379, 18380, 18381, 18268, 18269, 18270, 18271, 18272, 18273, 18274, 18275, 18276, 18277, 8140, 18407, 8144, 8135, 8139, 8137, 8131, 8127, 8128, 18408, 8133, 8130, 8142, 8146, 8141, 18409, 18410, 18411, 18412, 8143, 7363, 7376, 7377, 7372, 18413, 7378, 18414, 18415, 7373, 7374, 7369, 7370, 7366, 7364, 7368, 18382, 18383, 18384, 18385, 18386, 18387, 18388, 18389, 18390, 18391, 18416, 18392, 18393, 18394, 9147, 18395, 18417, 18396, 9146, 18397, 9143, 18398, 18399, 18418, 18400, 18401, 18402, 18403]

    loan_ids = [22061, 22062, 22063, 22064, 22065, 22066, 22067, 22068, 22069, 22070, 22071, 22072, 22073, 22074, 22075, 22076, 22077, 22078, 22079, 22080, 22081, 22082, 22083, 22084, 22085, 22086, 22087, 22088, 22089, 22090, 22091, 22092, 22093, 22094, 22095, 22096, 22097, 22098, 22099, 22100, 22101, 22102, 22103, 22104, 22105, 22106, 22107, 22108, 22109, 22110, 22111, 22112, 22113, 22114, 22115, 22116, 22117, 22118, 22119, 22120, 22121, 22122, 22123, 22124, 22125, 22126, 22127, 22128, 22129, 22130, 22131, 22132, 22133, 22134, 22135, 22136, 22137, 22138, 22139, 22140, 22141, 22142, 22143, 22144, 22145, 22146, 22147, 22148, 22149, 22150, 22151, 22152, 22153, 22154, 22155, 22156, 22157, 22158, 22159, 22160, 22161, 22162, 22163, 22164, 22165, 22166, 22167, 22168, 22169, 22170, 22171, 22172, 22173, 22174, 22175, 22176, 22177, 22178, 22179, 22180, 22181, 22182, 22183, 22184, 22185, 22186, 22187, 22188, 22189, 22190, 22191, 22192, 22193, 22194, 22195, 22196, 22197, 22198, 22199, 22200, 22201, 22202, 22203, 22204, 22205, 22206, 22207, 22208, 22209, 22210, 22211, 22212, 22213, 22214, 22215, 22216, 22217, 22218, 22219, 22220, 22221, 22222, 22223, 22224, 22225, 22226, 22227, 22228, 22229, 22230, 22231, 22232, 22233, 22234, 22235, 22236, 22237, 22238, 22239, 22240, 22241, 22242, 22243, 22244, 22245, 22246, 22247, 22248, 22249, 22250, 22251, 22252, 22253, 22254, 22255, 22256, 22257, 22258, 22259, 22260, 22261, 22262, 22263, 22264, 22265, 22266, 22267, 22268, 22269, 22270, 22271, 22272, 22273, 22274, 22275, 22276, 22277, 22278, 22279, 22280, 22281, 22282, 22283, 22284, 22285, 22286, 22287, 22288, 22289, 22290, 22291, 22292, 22293, 22294, 22295, 22296, 22297, 22298, 22299, 22300, 22301, 22302, 22303, 22304, 22305, 22306, 22307, 22308, 22309, 22310, 22311, 22312, 22313, 22314, 22315, 22316, 22317, 22318, 22319, 22320, 22321, 22322, 22323, 22324, 22325, 22326, 22327, 22328, 22329, 22330, 22331, 22332, 22333, 22334, 22335, 22336, 22337, 22338, 22339, 22340, 22341, 22342, 22343, 22344, 22345, 22346, 22347, 22348, 22349, 22350, 22351, 22352, 22353, 22354, 22355, 22356, 22357, 22358, 22359, 22360, 22361, 22362, 22363, 22364, 22365, 22366, 22367, 22368, 22369, 22370, 22371, 22372, 22373, 22374, 22375, 22376, 22377, 22378, 22379, 22380, 22381, 22382, 22383, 22384, 22385, 22386, 22387, 22388, 22389, 22390, 22391, 22392, 22393, 22394, 22395, 22396, 22397, 22398, 22399, 22400, 22401, 22402, 22403, 22404, 22405, 22406, 22407, 22408, 22409, 22410, 22411, 22412, 22413, 22414, 22415, 22416, 22417, 22418, 22419, 22420, 22421, 22422, 22423, 22424, 22425, 22426, 22427, 22428, 22429, 22430, 22431, 22432, 22433, 22434, 22435, 22436, 22437, 22438, 22439, 22440, 22441, 22442, 22443, 22444, 22445, 22446, 22447, 22448, 22449, 22451, 22456, 22457, 22458, 22459, 22460, 22461, 22462, 22463, 22464, 22465, 22466, 22467, 22468, 22469, 22470, 22471, 22472, 22473, 22474, 22475, 22476, 22477, 22478, 22479, 22480, 22481, 22482, 22483, 22484, 22485, 22486, 22487, 22488, 22489, 22490, 22491, 22492, 22493, 22494, 22495, 22496, 22497, 22498, 22499, 22500, 22501, 22502, 22503, 22504, 22505, 22506, 22507, 22508, 22509, 22510, 22511, 22512, 22513, 22514, 22515, 22516, 22517, 22518, 22519, 22520, 22521, 22522, 22523, 22524, 22525, 22526, 22527, 22528, 22529, 22530, 22531, 22532, 22533, 22534, 22535, 22536, 22537, 22538, 22539, 22540, 22541, 22542, 22543, 22544, 22545, 22546, 22547, 22548, 22549, 22550, 22551, 22552, 22553, 22554, 22555, 22556, 22557, 22558, 22559, 22560, 22561, 22562, 22563, 22564, 22565, 22566, 22567, 22568, 22569, 22570, 22571, 22572, 22573, 22574, 22575, 22576, 22577, 22578, 22579, 22580, 22581, 22582, 22583, 22584, 22585, 22586, 22587, 22588, 22589, 22590, 22591, 22592, 22593, 22594, 22595, 22596, 22597, 22598, 22599, 22600, 22601, 22602, 22603, 22604, 22605, 22606, 22607, 22608, 22609, 22610, 22611, 22612, 22613, 22614, 22615, 22616, 22617, 22618, 22619, 22620, 22621, 22622, 22623, 22624, 22625, 22626, 22627, 22628, 22629, 22630, 22631, 22632, 22633, 22634, 22635, 22636, 22637, 22638, 22639, 22640, 22641, 22642, 22643, 22644, 22645, 22646, 22647, 22648, 22649, 22650, 22651, 22652, 22653, 22654, 22655, 22656, 22657, 22658, 22659, 22660, 22661, 22662, 22663, 22664, 22665, 22666, 22667, 22668, 22669, 22670, 22671, 22672, 22673, 22674, 22675, 22676, 22677, 22678, 22679, 22680, 22681, 22682, 22683, 22684, 22685, 22686, 22687, 22688, 22689, 22690, 22691, 22692, 22693, 22694, 22695, 22696, 22697, 22698, 22699, 22700, 22701, 22702, 22703, 22704, 22705, 22706, 22707, 22708, 22709, 22710, 22711, 22712, 22713, 22714, 22715, 22716, 22717, 22718, 22719, 22720, 22721, 22722, 22723, 22724, 22725, 22726, 22727, 22728, 22729, 22730, 22731, 22732, 22733, 22734, 22735, 22736, 22737, 22738, 22739, 22740, 22741, 22742, 22743, 22744, 22745, 22746, 22747, 22748, 22749, 22750, 22751, 22752, 22753, 22754, 22755, 22756, 22757, 22758, 22759, 22760, 22761, 22762, 22763, 22764, 22765, 22766, 22767, 22768, 22769, 22770, 22771, 22772, 22773, 22774, 22775, 22776, 22777, 22778, 22779, 22780, 22781, 22782, 22783, 22784, 22785, 22786, 22787, 22788, 22789, 22790, 22791, 22792, 22793, 22794, 22795, 22796, 22797, 22798, 22799, 22800, 22801, 22802, 22803, 22804, 22805, 22806, 22807, 22808, 22809, 22810, 22811, 22812, 22813, 22814, 22815, 22816, 22817, 22818, 22819, 22820, 22821, 22822, 22823, 22824, 22825, 22826, 22827, 22828, 22829, 22830, 22831, 22832, 22833, 22834, 22835, 22836, 22837, 22838, 22839, 22840, 22841, 22842, 22843, 22844, 22845, 22846, 22847, 22848, 22849, 22850, 22851, 22852, 22853, 22854, 22855, 22856, 22857, 22858, 22859, 22860, 22861, 22862, 22863, 22864, 22865, 22866, 22867, 22868, 22869, 22870, 22871, 22872, 22873, 22874, 22875, 22876, 22877, 22878, 22879, 22880, 22881, 22882, 22883, 22884, 22885, 22886, 22887, 22888, 22889, 22890, 22891, 22892, 22893, 22894, 22895, 22896, 22897, 22898, 22899, 22900, 22901, 22902, 22903, 22904, 22905, 22906, 22907, 22908, 22909, 22910, 22911, 22912, 22913, 22914, 22915, 22916, 22917, 22918, 22919, 22920, 22921, 22922, 22923, 22924, 22925, 22926, 22927, 22928, 22929, 22930, 22931, 22932, 22933, 22934, 22935, 22936, 22937, 22938, 22939, 22940, 22941, 22942, 22943, 22944, 22945, 22946, 22948, 22949, 0, 22061, 22062, 22063, 22064, 22065, 22066, 22067, 22068, 22069, 22070, 22071, 22072, 22073, 22074, 22075, 22076, 22077, 22078, 22079, 22080, 22081, 22082, 22083, 22084, 22085, 22086, 22087, 22088, 22089, 22090, 22091, 22092, 22093, 22094, 22095, 22096, 22097, 22098, 22099, 22100, 22101, 22102, 22103, 22104, 22105, 22106, 22107, 22108, 22109, 22110, 22111, 22112, 22113, 22114, 22115, 22116, 22117, 22118, 22119, 22120, 22121, 22122, 22123, 22124, 22125, 22126, 22127, 22128, 22129, 22130, 22131, 22132, 22133, 22134, 22135, 22136, 22137, 22138, 22139, 22140, 22141, 22142, 22143, 22144, 22145, 22146, 22147, 22148, 22149, 22150, 22151, 22152, 22153, 22154, 22155, 22156, 22157, 22158, 22159, 22160, 22161, 22162, 22163, 22164, 22165, 22166, 22167, 22168, 22169, 22170, 22171, 22172, 22173, 22174, 22175, 22176, 22177, 22178, 22179, 22180, 22181, 22182, 22183, 22184, 22185, 22186, 22187, 22188, 22189, 22190, 22191, 22192, 22193, 22194, 22195, 22196, 22197, 22198, 22199, 22200, 22201, 22202, 22203, 22204, 22205, 22206, 22207, 22208, 22209, 22210, 22211, 22212, 22213, 22214, 22215, 22216, 22217, 22218, 22219, 22220, 22221, 22222, 22223, 22224, 22225, 22226, 22227, 22228, 22229, 22230, 22231, 22232, 22233, 22234, 22235, 22236, 22237, 22238, 22239, 22240, 22241, 22242, 22243, 22244, 22245, 22246, 22247, 22248, 22249, 22250, 22251, 22252, 22253, 22254, 22255, 22256, 22257, 22258, 22259, 22260, 22261, 22262, 22263, 22264, 22265, 22266, 22267, 22268, 22269, 22270, 22271, 22272, 22273, 22274, 22275, 22276, 22277, 22278, 22279, 22280, 22281, 22282, 22283, 22284, 22285, 22286, 22287, 22288, 22289, 22290, 22291, 22292, 22293, 22294, 22295, 22296, 22297, 22298, 22299, 22300, 22301, 22302, 22303, 22304, 22305, 22306, 22307, 22308, 22309, 22310, 22311, 22312, 22313, 22314, 22315, 22316, 22317, 22318, 22319, 22320, 22321, 22322, 22323, 22324, 22325, 22326, 22327, 22328, 22329, 22330, 22331, 22332, 22333, 22334, 22335, 22336, 22337, 22338, 22339, 22340, 22341, 22342, 22343, 22344, 22345, 22346, 22347, 22348, 22349, 22350, 22351, 22352, 22353, 22354, 22355, 22356, 22357, 22358, 22359, 22360, 22361, 22362, 22363, 22364, 22365, 22366, 22367, 22368, 22369, 22370, 22371, 22372, 22373, 22374, 22375, 22376, 22377, 22378, 22379, 22380, 22381, 22382, 22383, 22384, 22385, 22386, 22387, 22388, 22389, 22390, 22391, 22392, 22393, 22394, 22395, 22396, 22397, 22398, 22399, 22400, 22401, 22402, 22403, 22404, 22405, 22406, 22407, 22408, 22409, 22410, 22411, 22412, 22413, 22414, 22415, 22416, 22417, 22418, 22419, 22420, 22421, 22422, 22423, 22424, 22425, 22426, 22427, 22428, 22429, 22430, 22431, 22432, 22433, 22434, 22435, 22436, 22437, 22438, 22439, 22440, 22441, 22442, 22443, 22444, 22445, 22446, 22447, 22448, 22449, 22451, 22456, 22457, 22458, 22459, 22460, 22461, 22462, 22463, 22464, 22465, 22466, 22467, 22468, 22469, 22470, 22471, 22472, 22473, 22474, 22475, 22476, 22477, 22478, 22479, 22480, 22481, 22482, 22483, 22484, 22485, 22486, 22487, 22488, 22489, 22490, 22491, 22492, 22493, 22494, 22495, 22496, 22497, 22498, 22499, 22500, 22501, 22502, 22503, 22504, 22505, 22506, 22507, 22508, 22509, 22510, 22511, 22512, 22513, 22514, 22515, 22516, 22517, 22518, 22519, 22520, 22521, 22522, 22523, 22524, 22525, 22526, 22527, 22528, 22529, 22530, 22531, 22532, 22533, 22534, 22535, 22536, 22537, 22538, 22539, 22540, 22541, 22542, 22543, 22544, 22545, 22546, 22547, 22548, 22549, 22550, 22551, 22552, 22553, 22554, 22555, 22556, 22557, 22558, 22559, 22560, 22561, 22562, 22563, 22564, 22565, 22566, 22567, 22568, 22569, 22570, 22571, 22572, 22573, 22574, 22575, 22576, 22577, 22578, 22579, 22580, 22581, 22582, 22583, 22584, 22585, 22586, 22587, 22588, 22589, 22590, 22591, 22592, 22593, 22594, 22595, 22596, 22597, 22598, 22599, 22600, 22601, 22602, 22603, 22604, 22605, 22606, 22607, 22608, 22609, 22610, 22611, 22612, 22613, 22614, 22615, 22616, 22617, 22618, 22619, 22620, 22621, 22622, 22623, 22624, 22625, 22626, 22627, 22628, 22629, 22630, 22631, 22632, 22633, 22634, 22635, 22636, 22637, 22638, 22639, 22640, 22641, 22642, 22643, 22644, 22645, 22646, 22647, 22648, 22649, 22650, 22651, 22652, 22653, 22654, 22655, 22656, 22657, 22658, 22659, 22660, 22661, 22662, 22663, 22664, 22665, 22666, 22667, 22668, 22669, 22670, 22671, 22672, 22673, 22674, 22675, 22676, 22677, 22678, 22679, 22680, 22681, 22682, 22683, 22684, 22685, 22686, 22687, 22688, 22689, 22690, 22691, 22692, 22693, 22694, 22695, 22696, 22697, 22698, 22699, 22700, 22701, 22702, 22703, 22704, 22705, 22706, 22707, 22708, 22709, 22710, 22711, 22712, 22713, 22714, 22715, 22716, 22717, 22718, 22719, 22720, 22721, 22722, 22723, 22724, 22725, 22726, 22727, 22728, 22729, 22730, 22731, 22732, 22733, 22734, 22735, 22736, 22737, 22738, 22739, 22740, 22741, 22742, 22743, 22744, 22745, 22746, 22747, 22748, 22749, 22750, 22751, 22752, 22753, 22754, 22755, 22756, 22757, 22758, 22759, 22760, 22761, 22762, 22763, 22764, 22765, 22766, 22767, 22768, 22769, 22770, 22771, 22772, 22773, 22774, 22775, 22776, 22777, 22778, 22779, 22780, 22781, 22782, 22783, 22784, 22785, 22786, 22787, 22788, 22789, 22790, 22791, 22792, 22793, 22794, 22795, 22796, 22797, 22798, 22799, 22800, 22801, 22802, 22803, 22804, 22805, 22806, 22807, 22808, 22809, 22810, 22811, 22812, 22813, 22814, 22815, 22816, 22817, 22818, 22819, 22820, 22821, 22822, 22823, 22824, 22825, 22826, 22827, 22828, 22829, 22830, 22831, 22832, 22833, 22834, 22835, 22836, 22837, 22838, 22839, 22840, 22841, 22842, 22843, 22844, 22845, 22846, 22847, 22848, 22849, 22850, 22851, 22852, 22853, 22854, 22855, 22856, 22857, 22858, 22859, 22860, 22861, 22862, 22863, 22864, 22865, 22866, 22867, 22868, 22869, 22870, 22871, 22872, 22873, 22874, 22875, 22876, 22877, 22878, 22879, 22880, 22881, 22882, 22883, 22884, 22885, 22886, 22887, 22888, 22889, 22890, 22891, 22892, 22893, 22894, 22895, 22896, 22897, 22898, 22899, 22900, 22901, 22902, 22903, 22904, 22905, 22906, 22907, 22908, 22909, 22910, 22911, 22912, 22913, 22914, 22915, 22916, 22917, 22918, 22919, 22920, 22921, 22922, 22923, 22924, 22925, 22926, 22927, 22928, 22929, 22930, 22931, 22932, 22933, 22934, 22935, 22936, 22937, 22938, 22939, 22940, 22941, 22942, 22943, 22944, 22945, 22946, 22948, 22949]

    disbursal_dates = [Date.new(2012, 5, 28), Date.new(2012, 5, 29), Date.new(2012, 5, 30), Date.new(2012, 6, 1), Date.new(2012, 6, 4), Date.new(2012, 6, 5), Date.new(2012, 6, 6), Date.new(2012, 6, 7), Date.new(2012, 6, 8), Date.new(2012, 6, 9), Date.new(2012, 6, 14), Date.new(2012, 6, 15), Date.new(2012, 6, 16)]

    date = Date.new(2012, 4, 30)

    #following are the various dates on which monthly cash flows is being calculated.
    from_dates = [Date.new(2012, 5, 1), Date.new(2012, 6, 1), Date.new(2012, 7, 1), Date.new(2012, 8, 1), Date.new(2012, 9, 1), Date.new(2012, 10, 1), Date.new(2012, 11, 1), Date.new(2012, 12, 1), Date.new(2013, 1, 1), Date.new(2013, 2, 1), Date.new(2013, 3, 1), Date.new(2013, 4, 1), Date.new(2013, 5, 1)]

    to_dates = [Date.new(2012, 5, 31), Date.new(2012, 6, 30), Date.new(2012, 7, 31), Date.new(2012, 8, 31), Date.new(2012, 9, 30), Date.new(2012, 10, 31), Date.new(2012, 11, 30), Date.new(2012, 12, 31), Date.new(2013, 1, 31), Date.new(2013, 2, 28), Date.new(2013, 3, 31), Date.new(2013, 4, 30), Date.new(2013, 5, 31)]

    sl_no = 0

    f = File.open("tmp/mas_financials_#{DateTime.now.to_s}.csv", "w")
    f.puts("\"Sl. No.\", \"Branch Id\", \"Branch Name\", \"Center Id\", \"Center Name\", \"Client Id\", \"Client Name\", \"Date of Birth\", \"Caste\", \"Residence Address\", \"Residence Pin Code\", \"State\", \"Residence Phone Number\", \"Name of Assets\", \"Gross Income\", \"Gender\", \"Name of Marketing Executive\", \"Loan Id\", \"Purpose of Loans\", \"Category of Loanee\", \"Cycle Number\", \"Date of Disbursement\", \"Disbursement Mode\", \"Disbursement Cheque Number\", \"First Installment Date\", \"Last Installment Date\", \"Scheme IRR (%)\", \"Amount Financed\", \"Upfront Fees Amount in Rs.\", \"Insurance Charges\", \"Any Other Charges\", \"Installment Amount\", \"Tenure in Weeks\", \"Advance EMI\", \"No. Of Installment\", \"EMI Frequency\", \"Seasoning\", \"OD. Inst.\", \"Od. Amt. Rs.\", \"SD Amt. Rs.\", \"SD. Refund / Scheme Refund\", \"Mode of Repayment\", \"KYC Detail\", \"Future Capital O/S Amt. Rs.\", \"Future O/S Installment\", \"Future Receivable Amt. Rs.\", \"Cash Flow in March 2012\", \"Cash Flow in April 2012\", \"Cash Flow in May 2012\", \"Cash Flow in June 2012\", \"Cash Flow in July 2012\", \"Cash Flow in August 2012\", Cash Flow in September 2012, \"Cash Flow in October 2012\", \"Cash Flow in November 2012\", \"Cash Flow in December 2012\", \"Cash Flow in January 2013\", \"Cash Flow in February 2013\", \"Cash Flow in March 2013\", \"Cash Flow in April 2013\", \"Cash Flow in May 2013\", \"Cash Flow in June 2013\", \"Cash Flow in July 2013\", \"Cash Flow in August 2013\", \"Cash Flow in September 2013\", \"Cash Flow in October 2013\", \"Cash Flow in November 2013\", \"Cash Flow in December 2013\", \"Cash Flow in January 2014\", \"Cash Flow in February 2014\", \"Cash Flow in March 2014\", \"Cash Flow in April 2014\", \"Cash Flow in May 2014\", \"Cash Flow in June 2014\", \"Cash Flow in July 2014\", \"Cash Flow in August 2014\"")

    Loan.all(:id => loan_ids, :client_id => client_ids, :disbursal_date => disbursal_dates).each do |loan|

      sl_no += 1

      client = Client.get(loan.client_id)
      client_id = client.id
      client_name = client.name
      client_date_of_birth = client.date_of_birth
      client_caste = client.caste
      client_address = ""
      client_address_pin_code = client.address_pin
      client_state = "Bihar"
      if client.phone_number
        client_phone_number = client.phone_number
      else
        client_phone_number = "Not Specified"
      end
      client_name_of_assets = "NA"
      client_gross_income = client.total_income
      client_gender = client.gender.capitalize
      client_marketing_executive = client.center.manager.name

      center_id = client.center.id
      center_name = client.center.name

      branch_id = client.center.branch.id
      branch_name = client.center.branch.name

      loan_id = loan.id
      loan_cycle_number = loan.cycle_number
      loan_category = "NA"
      loan_purpose = (loan.occupation ? loan.occupation.name : "Not specified")
      loan_disbursal_date = loan.disbursal_date
      if loan.cheque_number.empty?
        loan_disbursement_mode = "Cash"
        loan_disbursement_cheque_number = "NA"
      else
        loan_disbursement_mode = "Cheque"
        loan_disbursement_cheque_number = loan.cheque_number
      end
      loan_first_installment_date = loan.scheduled_first_payment_date
      loan_last_installment_date = loan.loan_history.max(:date, :conditions => ['principal_due_today != ?', 0.0], :conditions => ['interest_due_today != ?', 0.0])
      loan_scheme_irr = (loan.irr * 100)
      loan_product_name = loan.loan_product.name
      loan_amount_financed = loan.amount
      loan_upfront_fees = loan.applicable_fees[0].amount
      loan_insurance_charges = loan.applicable_fees[1].amount
      loan_any_other_charges = "NA"
      loan_installment_amount = (loan.scheduled_principal_for_installment(1) + loan.scheduled_interest_for_installment(1))
      loan_tenure = loan.number_of_installments
      loan_advance_emi = ""
      loan_number_of_installments = loan.number_of_installments
      loan_installment_frequency = loan.installment_frequency.to_s.capitalize
      loan_seasoning = "NA"
      loan_overdue_installment = 0
      loan_overdue_amount = 0
      loan_sd_amount = "NA"
      loan_sd_refund = "NA"
      loan_mode_of_repayment = "Cash"
      loan_kyc_details = "Yes"
      loan_future_outstanding_amount = loan.scheduled_outstanding_total_on(date)
      loan_future_outstanding_installment = (loan.number_of_installments - loan.number_of_installments_before(date))
      loan_future_receivable_amount = (loan.total_to_be_received - loan.total_received_up_to(date))

      if (loan.scheduled_first_payment_date >= from_dates[0] and loan.scheduled_first_payment_date <= to_dates[0])
        monthly_cash_flow_march_2012 = (loan.scheduled_principal_for_installment(1) + loan.scheduled_interest_for_installment(1))
      else
        monthly_cash_flow_march_2012 = 0
      end
      monthly_cash_flow_april_2012 = (loan.scheduled_outstanding_total_on(from_dates[1]) - loan.scheduled_outstanding_total_on(to_dates[1]))
      monthly_cash_flow_may_2012 = (loan.scheduled_outstanding_total_on(from_dates[2]) - loan.scheduled_outstanding_total_on(to_dates[2]))
      monthly_cash_flow_june_2012 = (loan.scheduled_outstanding_total_on(from_dates[3]) - loan.scheduled_outstanding_total_on(to_dates[3]))
      monthly_cash_flow_july_2012 = (loan.scheduled_outstanding_total_on(from_dates[4]) - loan.scheduled_outstanding_total_on(to_dates[4]))
      monthly_cash_flow_august_2012 = (loan.scheduled_outstanding_total_on(from_dates[5]) - loan.scheduled_outstanding_total_on(to_dates[5]))
      monthly_cash_flow_september_2012 = (loan.scheduled_outstanding_total_on(from_dates[6]) - loan.scheduled_outstanding_total_on(to_dates[6]))
      monthly_cash_flow_october_2012 = (loan.scheduled_outstanding_total_on(from_dates[7]) - loan.scheduled_outstanding_total_on(to_dates[7]))
      monthly_cash_flow_november_2012 = (loan.scheduled_outstanding_total_on(from_dates[8]) - loan.scheduled_outstanding_total_on(to_dates[8]))
      monthly_cash_flow_december_2012 = (loan.scheduled_outstanding_total_on(from_dates[9]) - loan.scheduled_outstanding_total_on(to_dates[9]))

      monthly_cash_flow_january_2013 = (loan.scheduled_outstanding_total_on(from_dates[10]) - loan.scheduled_outstanding_total_on(to_dates[10]))
      monthly_cash_flow_february_2013 = (loan.scheduled_outstanding_total_on(from_dates[11]) - loan.scheduled_outstanding_total_on(to_dates[11]))
      monthly_cash_flow_march_2013 = (loan.scheduled_outstanding_total_on(from_dates[12]) - loan.scheduled_outstanding_total_on(to_dates[12]))
      monthly_cash_flow_april_2013 = (loan.scheduled_outstanding_total_on(from_dates[13]) - loan.scheduled_outstanding_total_on(to_dates[13]))
      monthly_cash_flow_may_2013 = (loan.scheduled_outstanding_total_on(from_dates[14]) - loan.scheduled_outstanding_total_on(to_dates[14]))
      monthly_cash_flow_june_2013 = (loan.scheduled_outstanding_total_on(from_dates[15]) - loan.scheduled_outstanding_total_on(to_dates[15]))
      monthly_cash_flow_july_2013 = (loan.scheduled_outstanding_total_on(from_dates[16]) - loan.scheduled_outstanding_total_on(to_dates[16]))
      monthly_cash_flow_august_2013 = (loan.scheduled_outstanding_total_on(from_dates[17]) - loan.scheduled_outstanding_total_on(to_dates[17]))
      monthly_cash_flow_september_2013 = (loan.scheduled_outstanding_total_on(from_dates[18]) - loan.scheduled_outstanding_total_on(to_dates[18]))
      monthly_cash_flow_october_2013 = (loan.scheduled_outstanding_total_on(from_dates[19]) - loan.scheduled_outstanding_total_on(to_dates[19]))
      monthly_cash_flow_november_2013 = (loan.scheduled_outstanding_total_on(from_dates[20]) - loan.scheduled_outstanding_total_on(to_dates[20]))
      monthly_cash_flow_december_2013 = (loan.scheduled_outstanding_total_on(from_dates[21]) - loan.scheduled_outstanding_total_on(to_dates[21]))

      monthly_cash_flow_january_2014 = (loan.scheduled_outstanding_total_on(from_dates[22]) - loan.scheduled_outstanding_total_on(to_dates[22]))
      monthly_cash_flow_february_2014 = (loan.scheduled_outstanding_total_on(from_dates[23]) - loan.scheduled_outstanding_total_on(to_dates[23]))
      monthly_cash_flow_march_2014 = (loan.scheduled_outstanding_total_on(from_dates[24]) - loan.scheduled_outstanding_total_on(to_dates[24]))
      monthly_cash_flow_april_2014 = (loan.scheduled_outstanding_total_on(from_dates[25]) - loan.scheduled_outstanding_total_on(to_dates[25]))
      monthly_cash_flow_may_2014 = (loan.scheduled_outstanding_total_on(from_dates[26]) - loan.scheduled_outstanding_total_on(to_dates[26]))
      monthly_cash_flow_june_2014 = (loan.scheduled_outstanding_total_on(from_dates[27]) - loan.scheduled_outstanding_total_on(to_dates[27]))
      monthly_cash_flow_july_2014 = (loan.scheduled_outstanding_total_on(from_dates[28]) - loan.scheduled_outstanding_total_on(to_dates[28]))
      monthly_cash_flow_august_2014 = (loan.scheduled_outstanding_total_on(from_dates[29]) - loan.scheduled_outstanding_total_on(to_dates[29]))
      
      f.puts("#{sl_no}, #{branch_id}, \"#{branch_name}\", #{center_id}, \"#{center_name}\", #{client_id}, \"#{client_name}\", #{client_date_of_birth}, \"#{client_caste}\", \"#{client_address}\", #{client_address_pin_code}, \"#{client_state}\", #{client_phone_number}, \"#{client_name_of_assets}\", #{client_gross_income}, \"#{client_gender}\", \"#{client_marketing_executive}\", #{loan_id}, \"#{loan_purpose}\", \"#{loan_category}\", #{loan_cycle_number}, #{loan_disbursal_date}, \"#{loan_disbursement_mode}\", \"#{loan_disbursement_cheque_number}\", #{loan_first_installment_date}, #{loan_last_installment_date}, \"#{loan_scheme_irr}\", #{loan_amount_financed}, #{loan_upfront_fees}, #{loan_insurance_charges}, #{loan_any_other_charges}, #{loan_installment_amount}, #{loan_tenure}, #{loan_advance_emi}, #{loan_number_of_installments}, \"#{loan_installment_frequency}\", \"#{loan_seasoning}\", #{loan_overdue_installment}, #{loan_overdue_amount}, \"#{loan_sd_amount}\", \"#{loan_sd_refund}\", \"#{loan_mode_of_repayment}\", \"#{loan_kyc_details}\", #{loan_future_outstanding_amount}, #{loan_future_outstanding_installment}, #{loan_future_receivable_amount}, #{monthly_cash_flow_march_2012}, #{monthly_cash_flow_april_2012}, #{monthly_cash_flow_may_2012}, #{monthly_cash_flow_june_2012}, #{monthly_cash_flow_july_2012}, #{monthly_cash_flow_august_2012}, #{monthly_cash_flow_september_2012}, #{monthly_cash_flow_october_2012}, #{monthly_cash_flow_november_2012}, #{monthly_cash_flow_december_2012}, #{monthly_cash_flow_january_2013}, #{monthly_cash_flow_february_2013}, #{monthly_cash_flow_march_2013}, #{monthly_cash_flow_april_2013}, #{monthly_cash_flow_may_2013}, #{monthly_cash_flow_june_2013}, #{monthly_cash_flow_july_2013}, #{monthly_cash_flow_august_2013}, #{monthly_cash_flow_september_2013}, #{monthly_cash_flow_october_2013}, #{monthly_cash_flow_november_2013}, #{monthly_cash_flow_december_2013}, #{monthly_cash_flow_january_2014}, #{monthly_cash_flow_february_2014}, #{monthly_cash_flow_march_2014}, #{monthly_cash_flow_april_2014}, #{monthly_cash_flow_may_2014}, #{monthly_cash_flow_june_2014}, #{monthly_cash_flow_july_2014}, #{monthly_cash_flow_august_2014}")

    end
    f.close
  end
end
